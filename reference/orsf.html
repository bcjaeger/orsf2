<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit an oblique random survival forest"><title>Oblique Random Survival Forest (ORSF) — orsf • aorsf</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Oblique Random Survival Forest (ORSF) — orsf"><meta property="og:description" content="Fit an oblique random survival forest"><meta property="og:image" content="https://bcjaeger.github.io/aorsf/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aorsf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/aorsf.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pd.html">PD and ICE curves with ORSF</a>
    <a class="dropdown-item" href="../articles/oobag.html">Out-of-bag predictions and evaluation</a>
    <a class="dropdown-item" href="../articles/fast.html">Tips to speed up computation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/aorsf/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Oblique Random Survival Forest (ORSF)</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/aorsf/blob/HEAD/R/orsf.R" class="external-link"><code>R/orsf.R</code></a></small>
      <div class="d-none name"><code>orsf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit an oblique random survival forest</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orsf</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_tree <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n_split <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  n_retry <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_thread <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mtry <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_with_replacement <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sample_fraction <span class="op">=</span> <span class="fl">0.632</span>,</span>
<span>  leaf_min_events <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  leaf_min_obs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  split_rule <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_min_events <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  split_min_obs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  split_min_stat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oobag_pred_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oobag_pred_horizon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oobag_eval_every <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oobag_fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  importance <span class="op">=</span> <span class="st">"anova"</span>,</span>
<span>  importance_max_pvalue <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  group_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tree_seeds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  attach_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  no_fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na_action <span class="op">=</span> <span class="st">"fail"</span>,</span>
<span>  verbose_progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">orsf_train</span><span class="op">(</span><span class="va">object</span>, attach_data <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>, <a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a>, or <a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a> that contains the
relevant variables.</p></dd>


<dt>formula</dt>
<dd><p>(<em>formula</em>) Two sided formula with a single outcome.
The terms on the right are names of predictor variables, and the
symbol '.' may be used to indicate all variables in the data
except the response. The symbol '-' may also be used to indicate
removal of a predictor. Details on the response vary depending
on forest type:</p><ul><li><p><em>Survival</em>: The response should include a time variable,
followed by a status variable, and may be written inside a
call to <a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a> (see examples).</p></li>
<li><p><em>Classification</em>: The response should be a single variable,
and that variable should have type <code>factor</code> in <code>data</code>.</p></li>
<li><p><em>Regression</em>: The response should be a single variable, and
that variable should have typee <code>double</code> or <code>integer</code> with at
least 10 unique numeric values in <code>data</code>.</p></li>
</ul></dd>


<dt>control</dt>
<dd><p>(<em>orsf_control</em>) An object returned from one of the
<code>orsf_control</code> functions: <a href="orsf_control.html">orsf_control_survival</a>,
<a href="orsf_control.html">orsf_control_classification</a>, and <a href="orsf_control.html">orsf_control_regression</a>. If
<code>NULL</code> (the default) will use an accelerated control, which is the
fastest available option. For survival and classification, this is
Cox and Logistic regression with 1 iteration, and for regression
it is ordinary least squares.</p></dd>


<dt>weights</dt>
<dd><p>(<em>numeric vector</em>) Optional. If given, this input should
have length equal to <code>nrow(data)</code> for complete or imputed data and should
have length equal to <code>nrow(na.omit(data))</code> if <code>na_action</code> is <code>"omit"</code>.
As the weights vector is used to count observations and events prior to
growing a node for a tree, <code>orsf()</code> scales <code>weights</code> so that
<code>sum(weights) == nrow(data)</code>. This helps to make tree depth consistent
between weighted and un-weighted fits.</p></dd>


<dt>n_tree</dt>
<dd><p>(<em>integer</em>) the number of trees to grow.
Default is <code>n_tree = 500.</code></p></dd>


<dt>n_split</dt>
<dd><p>(<em>integer</em>) the number of cut-points assessed when splitting
a node in decision trees. Default is <code>n_split = 5</code>.</p></dd>


<dt>n_retry</dt>
<dd><p>(<em>integer</em>) when a node is splittable, but the current
linear combination of inputs is unable to provide a valid split, <code>orsf</code>
will try again with a new linear combination based on a different set
of randomly selected predictors, up to <code>n_retry</code> times. Default is
<code>n_retry = 3</code>. Set <code>n_retry = 0</code> to prevent any retries.</p></dd>


<dt>n_thread</dt>
<dd><p>(<em>integer</em>) number of threads to use while growing trees, computing predictions, and computing importance. Default is one thread. To use the maximum number of threads that your system provides for concurrent execution, set <code>n_thread = 0</code>.</p></dd>


<dt>mtry</dt>
<dd><p>(<em>integer</em>) Number of predictors randomly included as candidates
for splitting a node. The default is the smallest integer greater than
the square root of the number of total predictors, i.e.,
<code>mtry = ceiling(sqrt(number of predictors))</code></p></dd>


<dt>sample_with_replacement</dt>
<dd><p>(<em>logical</em>) If <code>TRUE</code> (the default),
observations are sampled with replacement when an in-bag sample
is created for a decision tree. If <code>FALSE</code>, observations are
sampled without replacement and each tree will have an in-bag sample
containing <code>sample_fraction</code>% of the original sample.</p></dd>


<dt>sample_fraction</dt>
<dd><p>(<em>double</em>) the proportion of observations that
each trees' in-bag sample will contain, relative to the number of
rows in <code>data</code>. Only used if <code>sample_with_replacement</code> is <code>FALSE</code>.
Default value is 0.632.</p></dd>


<dt>leaf_min_events</dt>
<dd><p>(<em>integer</em>) minimum number of events in a
leaf node. Default is <code>leaf_min_events = 1</code></p></dd>


<dt>leaf_min_obs</dt>
<dd><p>(<em>integer</em>) minimum number of observations in a
leaf node. Default is <code>leaf_min_obs = 5</code>.</p></dd>


<dt>split_rule</dt>
<dd><p>(<em>character</em>) how to assess the quality of a potential
splitting rule for a node. Valid options for survival are:</p><ul><li><p>'logrank' : a log-rank test statistic (default).</p></li>
<li><p>'cstat'   : Harrell's concordance statistic.</p></li>
</ul><p>For classification, valid options are:</p><ul><li><p>'gini'  : gini impurity (default)</p></li>
<li><p>'cstat' : area underneath the ROC curve (AUC-ROC)</p></li>
</ul><p>For regression, valid options are:</p><ul><li><p>'variance' : variance reduction (default)</p></li>
</ul></dd>


<dt>split_min_events</dt>
<dd><p>(<em>integer</em>) minimum number of events required
in a node to consider splitting it. Default is <code>split_min_events = 5</code>.
This input is only relevant for survival trees.</p></dd>


<dt>split_min_obs</dt>
<dd><p>(<em>integer</em>) minimum number of observations required
in a node to consider splitting it. Default is <code>split_min_obs = 10</code>.</p></dd>


<dt>split_min_stat</dt>
<dd><p>(double) minimum test statistic required to split
a node. If no splits are found with a statistic exceeding <code>split_min_stat</code>,
the given node either becomes a leaf or a retry occurs (up to <code>n_retry</code>
retries). Defaults are</p><ul><li><p>3.84 if <code>split_rule = 'logrank'</code></p></li>
<li><p>0.55 if <code>split_rule = 'cstat'</code> (see first note below)</p></li>
<li><p>0.00 if <code>split_rule = 'gini'</code> (see second note below)</p></li>
<li><p>0.00 if <code>split_rule = 'variance'</code></p></li>
</ul><p><strong>Note 1</strong> For C-statistic splitting, if C is &lt; 0.50, we consider the statistic
value to be 1 - C to allow for good 'anti-predictive' splits. So,
if a C-statistic is initially computed as 0.1, it will be considered
as 1 - 0.10 = 0.90.</p>
<p><strong>Note 2</strong> For Gini impurity, a value of 0 and 1 usually indicate the best and
worst possible scores, respectively. To make things simple and to avoid
introducing a <code>split_max_stat</code> input, we flip the values of Gini
impurity so that 1 and 0 indicate the best and worst possible scores,
respectively.</p></dd>


<dt>oobag_pred_type</dt>
<dd><p>(<em>character</em>) The type of out-of-bag predictions
to compute while fitting the ensemble. Valid options for any tree type:</p><ul><li><p>'none' : don't compute out-of-bag predictions</p></li>
<li><p>'leaf' : the ID of the predicted leaf is returned for each tree</p></li>
</ul><p>Valid options for survival:</p><ul><li><p>'risk' : probability of event occurring at or before
<code>oobag_pred_horizon</code> (default).</p></li>
<li><p>'surv' : 1 - risk.</p></li>
<li><p>'chf'  : cumulative hazard function at <code>oobag_pred_horizon</code>.</p></li>
<li><p>'mort' : mortality, i.e., the number of events expected if all
observations in the training data were identical to a
given observation.</p></li>
</ul><p>Valid options for classification:</p><ul><li><p>'prob'  : probability of each class (default)</p></li>
<li><p>'class' : class (i.e., which.max(prob))</p></li>
</ul><p>Valid options for regression:</p><ul><li><p>'mean' : mean value (default)</p></li>
</ul></dd>


<dt>oobag_pred_horizon</dt>
<dd><p>(<em>numeric</em>) A numeric value indicating what time
should be used for out-of-bag predictions. Default is the median
of the observed times, i.e., <code>oobag_pred_horizon = median(time)</code>.
This input is only relevant for survival trees that have prediction
type of 'risk', 'surv', or 'chf'.</p></dd>


<dt>oobag_eval_every</dt>
<dd><p>(<em>integer</em>) The out-of-bag performance of the
ensemble will be checked every <code>oobag_eval_every</code> trees. So, if
<code>oobag_eval_every = 10</code>, then out-of-bag performance is checked
after growing the 10th tree, the 20th tree, and so on. Default
is <code>oobag_eval_every = n_tree</code>.</p></dd>


<dt>oobag_fun</dt>
<dd><p>(<em>function</em>) to be used for evaluating out-of-bag prediction accuracy every <code>oobag_eval_every</code>
trees. When <code>oobag_fun = NULL</code> (the default), the evaluation statistic is selected based on tree type</p><ul><li><p>survival: Harrell's C-statistic (1982)</p></li>
<li><p>classification: Area underneath the ROC curve (AUC-ROC)</p></li>
<li><p>regression: Traditional prediction R-squared</p></li>
</ul><p>if you use your own <code>oobag_fun</code> note the following:</p><ul><li><p><code>oobag_fun</code> should have three inputs: <code>y_mat</code>, <code>w_vec</code>, and <code>s_vec</code></p></li>
<li><p>For survival trees, <code>y_mat</code> should be a two column matrix with first column named 'time' and second named 'status'. For classification trees, <code>y_mat</code> should be a matrix with number of columns = number of distinct classes in the outcome. For regression, <code>y_mat</code> should be a matrix with one column.</p></li>
<li><p><code>s_vec</code> is a numeric vector containing predictions</p></li>
<li><p><code>oobag_fun</code> should return a numeric output of length 1</p></li>
</ul><p>For more details, see the out-of-bag <a href="https://docs.ropensci.org/aorsf/articles/oobag.html#user-supplied-out-of-bag-evaluation-functions" class="external-link">vignette</a>.</p></dd>


<dt>importance</dt>
<dd><p>(<em>character</em>) Indicate method for variable importance:</p><ul><li><p>'none': no variable importance is computed.</p></li>
<li><p>'anova': compute analysis of variance (ANOVA) importance</p></li>
<li><p>'negate': compute negation importance</p></li>
<li><p>'permute': compute permutation importance</p></li>
</ul><p>For details on these methods, see <a href="orsf_vi.html">orsf_vi</a>.</p></dd>


<dt>importance_max_pvalue</dt>
<dd><p>(<em>double</em>) Only relevant if <code>importance</code>
is <code>"anova"</code>. The maximum p-value that will register as a positive
case when counting the number of times a variable was found to be
'significant' during tree growth. Default is 0.01, as recommended
by Menze et al.</p></dd>


<dt>group_factors</dt>
<dd><p>(<em>logical</em>) Only relevant if variable importance is
being estimated. if <code>TRUE</code>, the importance of factor variables will be reported overall by aggregating the importance of individual levels of the factor. If <code>FALSE</code>, the importance of individual factor levels will be returned.</p></dd>


<dt>tree_seeds</dt>
<dd><p>(<em>integer vector</em>) Optional. if specified, random seeds
will be set using the values in <code>tree_seeds[i]</code>  before growing tree <code>i</code>.
Two forests grown with the same number of trees and the same seeds will
have the exact same out-of-bag samples, making out-of-bag error
estimates of the forests more comparable. If <code>NULL</code> (the default),
seeds are picked at random.</p></dd>


<dt>attach_data</dt>
<dd><p>(<em>logical</em>) if <code>TRUE</code>, a copy of the training
data will be attached to the output. This is required if you
plan on using functions like <a href="orsf_pd_oob.html">orsf_pd_oob</a> or <a href="orsf_summarize_uni.html">orsf_summarize_uni</a>
to interpret the forest using its training data. Default is <code>TRUE</code>.</p></dd>


<dt>no_fit</dt>
<dd><p>(<em>logical</em>) if <code>TRUE</code>, model fitting steps are defined and
saved, but training is not initiated. The object returned can be
directly submitted to <code>orsf_train()</code> so long as <code>attach_data</code> is <code>TRUE</code>.</p></dd>


<dt>na_action</dt>
<dd><p>(<em>character</em>) what should happen when <code>data</code> contains missing values (i.e., <code>NA</code> values). Valid options are:</p><ul><li><p>'fail' : an error is thrown if <code>data</code> contains <code>NA</code> values</p></li>
<li><p>'omit' : rows in <code>data</code> with incomplete data will be dropped</p></li>
<li><p>'impute_meanmode' : missing values for continuous and categorical variables in <code>data</code> will be imputed using the mean and mode, respectively.</p></li>
</ul></dd>


<dt>verbose_progress</dt>
<dd><p>(<em>logical</em>) if <code>TRUE</code>, progress messages are
printed in the console. If <code>FALSE</code> (the default), nothing is printed.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods (not currently used).</p></dd>


<dt>object</dt>
<dd><p>an untrained 'aorsf' object, created by setting
<code>no_fit = TRUE</code> in <code>orsf()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an accelerated oblique RSF object (<code>aorsf</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is based on and similar to the <code>ORSF</code> function
in the <code>obliqueRSF</code> R package. The primary difference is that this
function runs much faster. The speed increase is attributable to better
management of memory (i.e., no unnecessary copies of inputs) and using
a Newton Raphson scoring algorithm to identify linear combinations of
inputs rather than performing penalized regression using routines in
<code>glmnet</code>.The modified Newton Raphson scoring algorithm that this
function applies is an adaptation of the C++ routine developed by
Terry M. Therneau that fits Cox proportional hazards models
(see <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code> and more specifically <code><a href="https://rdrr.io/pkg/survival/man/agreg.fit.html" class="external-link">survival::coxph.fit()</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details-on-inputs">Details on inputs<a class="anchor" aria-label="anchor" href="#details-on-inputs"></a></h2>
    


<p><strong>formula</strong>:</p><ul><li><p>The response in <code>formula</code> can be a survival
object as returned by the <a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a> function,
but can also just be the time and status variables. I.e.,
<code>Surv(time, status) ~ .</code> works just like <code>time + status ~ .</code></p></li>
<li><p>A <code>.</code> symbol on the right hand side is short-hand for using all
variables in <code>data</code> (omitting those on the left hand side of
<code>formula</code>) as predictors.</p></li>
<li><p>The order of variables in the left hand side matters. i.e.,
writing <code>status + time ~ .</code> will make <code>orsf</code> assume your
<code>status</code> variable is actually the <code>time</code> variable.</p></li>
<li><p>The response variable can be a survival object stored in <code>data</code>.
For example, y ~ . is a valid formula if <code>data$y</code> inherits
from the <code>Surv</code> class.</p></li>
<li><p>Although you can fit an oblique random survival forest with 1 predictor
variable, your formula should have at least 2 predictors. The reason for
this recommendation is that a linear combination of predictors is trivial
if there is only one predictor.</p></li>
</ul><p><strong>mtry</strong>:</p>
<p>The <code>mtry</code> parameter may be temporarily reduced to ensure there
are at least 2 events per predictor variable. This occurs when using
<a href="orsf_control_cph.html">orsf_control_cph</a> because coefficients in the Newton Raphson scoring
algorithm may become unstable when the number of covariates is
greater than or equal to the number of events. This reduction does not
occur when using <a href="orsf_control_net.html">orsf_control_net</a>.</p>
<p><strong>oobag_fun</strong>:</p>
<p>If <code>oobag_fun</code> is specified, it will be used in to compute negation
importance or permutation importance, but it will not have any role
for ANOVA importance.</p>
<p><strong>n_thread</strong>:</p>
<p>If an R function must be called from C++ (i.e., user-supplied function to
compute out-of-bag error or identify linear combinations of variables),
<code>n_thread</code> will automatically be set to 1 because attempting to run R
functions in multiple threads will cause the R session to crash.</p>
    </div>
    <div class="section level2">
    <h2 id="what-is-an-oblique-decision-tree-">What is an oblique decision tree?<a class="anchor" aria-label="anchor" href="#what-is-an-oblique-decision-tree-"></a></h2>
    


<p>Decision trees are developed by splitting a set of training data into two
new subsets, with the goal of having more similarity within the new subsets
than between them. This splitting process is repeated on the resulting
subsets of data until a stopping criterion is met. When the new subsets of
data are formed based on a single predictor, the decision tree is said to
be axis-based because the splits of the data appear perpendicular to the
axis of the predictor. When linear combinations of variables are used
instead of a single variable, the tree is oblique because the splits of
the data are neither parallel nor at a right angle to the axis</p>
<p><em>Figure</em> : Decision trees for classification with axis-based splitting
(left) and oblique splitting (right). Cases are orange squares; controls
are purple circles. Both trees partition the predictor space defined by
variables X1 and X2, but the oblique splits do a better job of separating
the two classes.</p>
<p><img src="figures/tree_axis_v_oblique.png" width="95%"></p>
    </div>
    <div class="section level2">
    <h2 id="what-is-a-random-forest-">What is a random forest?<a class="anchor" aria-label="anchor" href="#what-is-a-random-forest-"></a></h2>
    


<p>Random forests are collections of de-correlated decision trees.
Predictions from each tree are aggregated to make an ensemble
prediction for the forest. For more details, see Breiman at el, 2001.</p>
    </div>
    <div class="section level2">
    <h2 id="training-out-of-bag-error-and-testing">Training, out-of-bag error, and testing<a class="anchor" aria-label="anchor" href="#training-out-of-bag-error-and-testing"></a></h2>
    


<p>In random forests, each tree is grown with a bootstrapped version of
the training set. Because bootstrap samples are selected with replacement,
each bootstrapped training set contains about two-thirds of instances in
the original training set. The 'out-of-bag' data are instances that are
<em>not</em> in the bootstrapped training set. Each tree in the random forest
can make predictions for its out-of-bag data, and the out-of-bag
predictions can be aggregated to make an ensemble out-of-bag prediction.
Since the out-of-bag data are not used to grow the tree, the accuracy of
the ensemble out-of-bag predictions approximate the generalization error
of the random forest. Generalization error refers to the error of a
random forest's predictions when it is applied to predict outcomes for
data that were not used to train it, i.e., testing data.</p>
    </div>
    <div class="section level2">
    <h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a></h2>
    


<p>Data passed to aorsf functions are not allowed to have missing values.
A user should impute missing values using an R package with that purpose,
such as <code>recipes</code> or <code>mlr3pipelines</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>
    <p><code>orsf()</code> is the entry-point of the <code>aorsf</code> package. It can be used to
fit classification, regression, and survival forests. It can also
compute out-of-bag prediction accuracy or out-of-bag variable importance
using built-in functions or custom functions supplied by users.</p>
<p>First we load some relevant packages</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">329730</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/aorsf" class="external-link">aorsf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></code></pre><p></p></div><div class="section">
<h3 id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a></h3>


<p>We’ll use the outstanding <code>penguin</code> data for this example:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="co"># penguins_orsf is a copy of the penguins data</span></span>
<span><span class="co"># from palmerpenguins but only includes complete cases:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">penguins_orsf</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 x 8</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;int&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Adelie  Torgersen           39.1          18.7               181        3750</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Adelie  Torgersen           39.5          17.4               186        3800</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Adelie  Torgersen           40.3          18                 195        3250</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Adelie  Torgersen           36.7          19.3               193        3450</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 Adelie  Torgersen           39.3          20.6               190        3650</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 Adelie  Torgersen           38.9          17.8               181        3625</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## # i 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</span></span></code></pre><p></p></div>
<p>The <code>orsf()</code> function will automatically fit a classification forest if
the outcome variable is a factor:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fit_penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins_orsf</span>,</span>
<span>                     formula <span class="op">=</span> <span class="va">species</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">flipper_length_mm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_penguins</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---------- Oblique random classification forest</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Linear combinations: Accelerated Logistic regression</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           N observations: 333</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                N classes: 3</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                  N trees: 500</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       N predictors total: 2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    N predictors per node: 2</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Average leaves per tree: 5.896</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Min observations in leaf: 5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">##           OOB stat value: 0.99</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">##            OOB stat type: AUC-ROC</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      Variable importance: anova</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span></code></pre><p></p></div>
<p>You can also tell <code>orsf()</code> to do classification manually if you’d prefer
keeping a numeric outcome. The way to do this is through the <code>control</code>
argument:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">penguins_numeric</span> <span class="op">&lt;-</span> <span class="va">penguins_orsf</span></span>
<span><span class="va">penguins_numeric</span><span class="op">$</span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">penguins_numeric</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span><span class="va">penguins_numeric</span>,</span>
<span>                    formula <span class="op">=</span> <span class="va">species</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">flipper_length_mm</span>,</span>
<span>                    control <span class="op">=</span> <span class="fu"><a href="../reference/orsf_control.html">orsf_control_classification</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_numeric</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---------- Oblique random classification forest</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Linear combinations: Logistic regression</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           N observations: 333</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                N classes: 3</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                  N trees: 500</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       N predictors total: 2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    N predictors per node: 2</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Average leaves per tree: 6.134</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Min observations in leaf: 5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">##           OOB stat value: 0.99</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">##            OOB stat type: AUC-ROC</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      Variable importance: anova</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span></code></pre><p></p></div>
<p>You could also use <code>orsf_update</code> to make <code>fit_numeric</code> simply by giving
it a new <code>data</code> argument</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/orsf_update.html">orsf_update</a></span><span class="op">(</span><span class="va">fit_penguins</span>, data <span class="op">=</span> <span class="va">penguins_numeric</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---------- Oblique random classification forest</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Linear combinations: Accelerated Logistic regression</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           N observations: 333</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                N classes: 3</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                  N trees: 500</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       N predictors total: 2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    N predictors per node: 2</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Average leaves per tree: 5.896</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Min observations in leaf: 5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">##           OOB stat value: 0.99</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">##            OOB stat type: AUC-ROC</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      Variable importance: anova</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span></code></pre><p></p></div><div class="section">
<h4 id="difference-between-oblique-and-axis-based">Difference between oblique and axis-based<a class="anchor" aria-label="anchor" href="#difference-between-oblique-and-axis-based"></a></h4>


<p>For this example, we modify integer columns in the penguins data to be
doubles so that <code>aorsf</code> will not throw an error when we ask it to
predict at non-integer values of these predictors:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">penguins_orsf</span> <span class="op">&lt;-</span> <span class="va">penguins_orsf</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">mutate</span><span class="op">(</span>bill_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>        flipper_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>We will also use the same code to make several plots, so I define a
function below to minimize repetition.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">plot_decision_surface</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">predictions</span>, <span class="va">grid</span>, <span class="va">title</span><span class="op">)</span><span class="op">{</span></span>
<span> </span>
<span> <span class="co"># this is not a general function for plotting</span></span>
<span> <span class="co"># decision surfaces. It just helps to minimize </span></span>
<span> <span class="co"># copying and pasting of code.</span></span>
<span> </span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">penguins_orsf</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span> </span>
<span> <span class="va">class_preds</span> <span class="op">&lt;-</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">grid</span>, <span class="va">predictions</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Adelie</span>,</span>
<span>                        <span class="va">Chinstrap</span>,</span>
<span>                        <span class="va">Gentoo</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">flipper_length_mm</span>, <span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span> </span>
<span> <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"purple"</span>, <span class="st">"cyan4"</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">class_preds</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_contour_filled</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>z <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins_orsf</span>,</span>
<span>             <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">cols</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">cols</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"\nBill length, scaled"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Bill depth, scaled\n"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">''</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span></span>
<span> </span>
<span><span class="op">}</span></span></code></pre><p></p></div>
<p>We also use a grid of points for plotting the decision surface, which is
created as follows:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span></span>
<span></span>
<span> flipper_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">penguins_orsf</span><span class="op">$</span><span class="va">flipper_length_mm</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">penguins_orsf</span><span class="op">$</span><span class="va">flipper_length_mm</span><span class="op">)</span>,</span>
<span>                  len <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span> bill_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">penguins_orsf</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">penguins_orsf</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>                      len <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
<p>Axis-based random forests comprise axis-based trees, which partition
data by splitting them into subgroups using a single variable.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="co"># ranger and randomForestSRC are fantastic packages for</span></span>
<span><span class="co"># axis-based random forests. For simplicity, we use orsf</span></span>
<span><span class="co"># to fit one here. Note that orsf with mtry = 1 is similar</span></span>
<span><span class="co"># to an extremely randomized axis-based forest </span></span>
<span></span>
<span><span class="va">fit_axis_tree</span> <span class="op">&lt;-</span> <span class="va">penguins_orsf</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">flipper_length_mm</span>,</span>
<span>      n_tree <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      mtry <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      tree_seeds <span class="op">=</span> <span class="fl">106760</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_axis_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_axis_tree</span>, new_data <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span></code></pre><p></p></div>
<p>With axis-based splits, decision boundaries will always be perpendicular
to the axis of the relevant predictor:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">plot_decision_surface</span><span class="op">(</span><span class="va">pred_axis_tree</span>, <span class="va">grid</span>, <span class="st">"Axis-based tree"</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/D:/aorsf/Rmd/figureunnamed-chunk-12-1.png" alt=""><!-- --></p>
<p>When predictions from hundreds of axis-based trees are aggregated, the
collective decision surface is much more flexible. However, even with
hundreds of axis-based trees, it is difficult to capture smooth decision
boundaries:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fit_axis_forest</span> <span class="op">&lt;-</span> <span class="va">fit_axis_tree</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu"><a href="../reference/orsf_update.html">orsf_update</a></span><span class="op">(</span>n_tree <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_axis_forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_axis_forest</span>, new_data <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_decision_surface</span><span class="op">(</span><span class="va">pred_axis_forest</span>, <span class="va">grid</span>, <span class="st">"Axis-based forest"</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/D:/aorsf/Rmd/figureunnamed-chunk-13-1.png" alt=""><!-- --></p>
<p>Instead of using a single predictor to split data, oblique trees use a
weighted combination of predictors. This creates decision boundaries
that are neither parallel or perpendicular to the axes of corresponding
predictors:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fit_oblique_tree</span> <span class="op">&lt;-</span> <span class="va">fit_axis_tree</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu"><a href="../reference/orsf_update.html">orsf_update</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_oblique_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_oblique_tree</span>, new_data <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_decision_surface</span><span class="op">(</span><span class="va">pred_oblique_tree</span>, <span class="va">grid</span>, <span class="st">"Oblique tree"</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/D:/aorsf/Rmd/figureunnamed-chunk-14-1.png" alt=""><!-- --></p>
<p>And, when predictions from these trees are aggregated, they do a great
job of capturing smooth geometries!</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fit_oblique_forest</span> <span class="op">&lt;-</span> <span class="va">fit_oblique_tree</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu"><a href="../reference/orsf_update.html">orsf_update</a></span><span class="op">(</span>n_tree <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_oblique_forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_oblique_forest</span>, </span>
<span>                               new_data <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_decision_surface</span><span class="op">(</span><span class="va">pred_oblique_forest</span>, <span class="va">grid</span>, <span class="st">"Oblique forest"</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="figures/D:/aorsf/Rmd/figureunnamed-chunk-15-1.png" alt=""><!-- --></p>
</div>


</div>

<div class="section">
<h3 id="regression">Regression<a class="anchor" aria-label="anchor" href="#regression"></a></h3>


</div>

<div class="section">
<h3 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a></h3>


<p></p><div class="sourceCode r"><pre><code><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span><span class="va">pbc_orsf</span>, <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span><span class="op">)</span></span></code></pre><p></p></div>
<p>printing <code>fit</code> provides quick descriptive summaries:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">fit</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---------- Oblique random survival forest</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Linear combinations: Accelerated Cox regression</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           N observations: 276</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                 N events: 111</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                  N trees: 500</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       N predictors total: 17</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    N predictors per node: 5</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Average leaves per tree: 20.994</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Min observations in leaf: 5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">##       Min events in leaf: 1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">##           OOB stat value: 0.84</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##            OOB stat type: Harrell's C-index</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">##      Variable importance: anova</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="more-than-one-way-to-grow-a-forest">More than one way to grow a forest<a class="anchor" aria-label="anchor" href="#more-than-one-way-to-grow-a-forest"></a></h3>


<p>You can use <code>orsf(no_fit = TRUE)</code> to make a specification to grow a
forest that can be used as a blueprint for <code>orsf_train()</code>:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">orsf_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span><span class="va">pbc_orsf</span>, <span class="va">time</span> <span class="op">+</span> <span class="va">status</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span>, no_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">orsf_spec</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Untrained oblique random survival forest</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Linear combinations: Accelerated Cox regression</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           N observations: 276</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                 N events: 111</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                  N trees: 500</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       N predictors total: 17</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    N predictors per node: 5</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Average leaves per tree: 0</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Min observations in leaf: 5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">##       Min events in leaf: 1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">##           OOB stat value: none</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##            OOB stat type: Harrell's C-index</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">##      Variable importance: anova</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">orsf_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf_train</a></span><span class="op">(</span><span class="va">orsf_spec</span><span class="op">)</span></span>
<span><span class="va">orsf_fit</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---------- Oblique random survival forest</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Linear combinations: Accelerated Cox regression</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           N observations: 276</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                 N events: 111</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                  N trees: 500</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       N predictors total: 17</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    N predictors per node: 5</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Average leaves per tree: 20.854</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Min observations in leaf: 5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">##       Min events in leaf: 1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">##           OOB stat value: 0.84</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">##            OOB stat type: Harrell's C-index</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">##      Variable importance: anova</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span></code></pre><p></p></div>
<p>You can also update the specification in place when passing it to
<code>orsf_train()</code>, making it easy to fit several models from one spec:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">orsf_fit_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf_train</a></span><span class="op">(</span><span class="va">orsf_spec</span>, leaf_min_obs <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">orsf_fit_20</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf_train</a></span><span class="op">(</span><span class="va">orsf_spec</span>, leaf_min_obs <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orsf_fit</span><span class="op">$</span><span class="va">leaf_min_obs</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">orsf_fit_10</span><span class="op">$</span><span class="va">leaf_min_obs</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 10</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">orsf_fit_20</span><span class="op">$</span><span class="va">leaf_min_obs</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 20</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="tidymodels">tidymodels<a class="anchor" aria-label="anchor" href="#tidymodels"></a></h3>


<p><code>tidymodels</code> includes support for <code>aorsf</code> as a computational engine:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/yardstick" class="external-link">yardstick</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pbc_tidy</span> <span class="op">&lt;-</span> <span class="va">pbc_orsf</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">mutate</span><span class="op">(</span>event_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">time</span>, <span class="va">status</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split</span>  <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">pbc_tidy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orsf_spec</span> <span class="op">&lt;-</span> <span class="fu">rand_forest</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">set_engine</span><span class="op">(</span><span class="st">"aorsf"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">set_mode</span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orsf_fit</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">orsf_spec</span>, <span class="va">event_time</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu">training</span><span class="op">(</span><span class="va">split</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>Prediction with <code>aorsf</code> models at different times is also supported:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">3000</span>, by <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_pred</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">orsf_fit</span>, </span>
<span>                     new_data <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">split</span><span class="op">)</span>, </span>
<span>                     eval_time <span class="op">=</span> <span class="va">time_points</span><span class="op">)</span></span>
<span></span>
<span><span class="va">brier_scores</span> <span class="op">&lt;-</span> <span class="va">test_pred</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">brier_survival</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">event_time</span>, <span class="va">.pred</span><span class="op">)</span></span>
<span></span>
<span><span class="va">brier_scores</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 x 4</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   .metric        .estimator .eval_time .estimate</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;          &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 brier_survival standard          500    0.0333</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 brier_survival standard         1000    0.0668</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 brier_survival standard         1500    0.0653</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 brier_survival standard         2000    0.0580</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 brier_survival standard         2500    0.0785</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 brier_survival standard         3000    0.114</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">roc_scores</span> <span class="op">&lt;-</span> <span class="va">test_pred</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">roc_auc_survival</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">event_time</span>, <span class="va">.pred</span><span class="op">)</span></span>
<span></span>
<span><span class="va">roc_scores</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 x 4</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   .metric          .estimator .eval_time .estimate</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;            &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 roc_auc_survival standard          500     0.955</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 roc_auc_survival standard         1000     0.934</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 roc_auc_survival standard         1500     0.989</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 roc_auc_survival standard         2000     0.998</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 roc_auc_survival standard         2500     0.964</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 roc_auc_survival standard         3000     0.943</span></span></code></pre><p></p></div>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Harrell FE, Califf RM, Pryor DB, Lee KL, Rosati RA. Evaluating the Yield of Medical Tests. <em>JAMA</em> 1982; 247(18):2543-2546. DOI: 10.1001/jama.1982.03320430047030</p>
<p>Breiman L. Random forests. <em>Machine learning</em> 2001 Oct; 45(1):5-32. DOI: 10.1023/A:1010933404324</p>
<p>Ishwaran H, Kogalur UB, Blackstone EH, Lauer MS. Random survival forests. <em>Annals of applied statistics</em> 2008 Sep; 2(3):841-60. DOI: 10.1214/08-AOAS169</p>
<p>Menze BH, Kelm BM, Splitthoff DN, Koethe U, Hamprecht FA. On oblique random forests. <em>Joint European Conference on Machine Learning and Knowledge Discovery in Databases</em> 2011 Sep 4; pp. 453-469. DOI: 10.1007/978-3-642-23783-6_29</p>
<p>Jaeger BC, Long DL, Long DM, Sims M, Szychowski JM, Min YI, Mcclure LA, Howard G, Simon N. Oblique random survival forests. <em>Annals of applied statistics</em> 2019 Sep; 13(3):1847-83. DOI: 10.1214/19-AOAS1261</p>
<p>Jaeger BC, Welden S, Lenoir K, Speiser JL, Segar MW, Pandey A, Pajewski NM. Accelerated and interpretable oblique random survival forests. <em>Journal of Computational and Graphical Statistics</em> Published online 08 Aug 2023. DOI: 10.1080/10618600.2023.2231048</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Byron Jaeger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

