<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimate the importance of individual variables using oblique random
survival forests."><title>ORSF variable importance — orsf_vi • aorsf</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ORSF variable importance — orsf_vi"><meta property="og:description" content="Estimate the importance of individual variables using oblique random
survival forests."><meta property="og:image" content="https://bcjaeger.github.io/aorsf/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aorsf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/aorsf.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pd.html">Compute partial dependence with ORSF</a>
    <a class="dropdown-item" href="../articles/oobag.html">Out-of-bag predictions and evaluation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcjaeger/aorsf/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ORSF variable importance</h1>
      <small class="dont-index">Source: <a href="https://github.com/bcjaeger/aorsf/blob/HEAD/R/orsf_vi.R" class="external-link"><code>R/orsf_vi.R</code></a></small>
      <div class="d-none name"><code>orsf_vi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate the importance of individual variables using oblique random
survival forests.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orsf_vi</span><span class="op">(</span><span class="va">object</span>, group_factors <span class="op">=</span> <span class="cn">TRUE</span>, importance <span class="op">=</span> <span class="cn">NULL</span>, oobag_fun <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">orsf_vi_negate</span><span class="op">(</span><span class="va">object</span>, group_factors <span class="op">=</span> <span class="cn">TRUE</span>, oobag_fun <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">orsf_vi_permute</span><span class="op">(</span><span class="va">object</span>, group_factors <span class="op">=</span> <span class="cn">TRUE</span>, oobag_fun <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">orsf_vi_anova</span><span class="op">(</span><span class="va">object</span>, group_factors <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>(<em>orsf_fit</em>) a trained oblique random survival forest
(see <a href="orsf.html">orsf</a>).</p></dd>


<dt>group_factors</dt>
<dd><p>(<em>logical</em>) if <code>TRUE</code>, the importance of factor
variables will be reported overall by aggregating the importance
of individual levels of the factor. If <code>FALSE</code>, the importance of
individual factor levels will be returned.</p></dd>


<dt>importance</dt>
<dd><p>(<em>character</em>) Indicate method for variable importance:</p><ul><li><p>'anova': compute analysis of variance (ANOVA) importance</p></li>
<li><p>'negate': compute negation importance</p></li>
<li><p>'permute': compute permutation importance</p></li>
</ul></dd>


<dt>oobag_fun</dt>
<dd><p>(<em>function</em>) to be used for evaluating out-of-bag prediction accuracy after negating coefficients
(if importance = 'negate') or permuting the values of a predictor
(if importance = 'permute')</p><ul><li><p>When <code>oobag_fun = NULL</code> (the default), Harrell's C-statistic (1982) is used to evaluate accuracy.</p></li>
<li><p>if you use your own <code>oobag_fun</code> note the following:</p><ul><li><p><code>oobag_fun</code> should have two inputs: <code>y_mat</code> and <code>s_vec</code></p></li>
<li><p><code>y_mat</code> is a two column matrix with first column named 'time', second named 'status'</p></li>
<li><p><code>s_vec</code> is a numeric vector containing predicted survival probabilities.</p></li>
<li><p><code>oobag_fun</code> should return a numeric output of length 1</p></li>
<li><p>the same <code>oobag_fun</code> should have been used when you created <code>object</code>
so that the initial value of out-of-bag prediction accuracy is
consistent with the values that will be computed while variable
importance is estimated.</p></li>
</ul></li>
</ul><p>For more details, see the out-of-bag
<a href="https://bcjaeger.github.io/aorsf/articles/oobag.html">vignette</a>.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods (not currently used).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>orsf_vi</code> functions return a named numeric vector.</p><ul><li><p>Names of the vector are the predictor variables used by <code>object</code></p></li>
<li><p>Values of the vector are the estimated importance of the given predictor.</p></li>
</ul><p>The returned vector is sorted from highest to lowest value, with higher
values indicating higher importance.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When an <code>orsf_fit</code> object is fitted with importance = 'anova', 'negate', or
'permute', the output will have a vector of importance values based on
the requested type of importance. However, you may still want to call
<code>orsf_vi()</code> on this output if you want to group factor levels into one
overall importance value.</p>
<p><code>orsf_vi()</code> is a general purpose function to extract or compute variable
importance estimates from an <code>'orsf_fit'</code> object (see <a href="orsf.html">orsf</a>).
<code>orsf_vi_negate()</code>, <code>orsf_vi_permute()</code>, and <code>orsf_vi_anova()</code> are wrappers
for <code>orsf_vi()</code>. The way these functions work depends on whether the
<code>object</code> they are given already has variable importance estimates in it
or not (see examples).</p>
    </div>
    <div class="section level2">
    <h2 id="variable-importance-methods">Variable importance methods<a class="anchor" aria-label="anchor" href="#variable-importance-methods"></a></h2>
    


<p><strong>negation importance</strong>: Each variable is assessed separately by
multiplying the variable's coefficients by -1 and then determining
how much the model's performance changes. The worse the model's
performance after negating coefficients for a given variable,
the more important the variable.</p>
<p><strong>permutation importance</strong>: Each variable is assessed separately by
randomly permuting the variable's values and then determining
how much the model's performance changes. The worse the model's
performance after permuting the values of a given variable,
the more important the variable.</p>
<p><strong>analysis of variance (ANOVA) importance</strong>: computes a p-value for each
coefficient in each linear combination of variables in each decision
tree of an oblique random forest. Following the definition proposed by
Menze et al, ANOVA importance for an individual predictor variable is
the proportion of times a p-value for its coefficient is &lt; 0.01.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Harrell FE, Califf RM, Pryor DB, Lee KL, Rosati RA. Evaluating the Yield of Medical Tests. <em>JAMA</em> 1982; 247(18):2543-2546. DOI: 10.1001/jama.1982.03320430047030</p>
<p>Breiman L. Random forests. <em>Machine learning</em> 2001 Oct; 45(1):5-32. DOI: 10.1023/A:1010933404324</p>
<p>Menze BH, Kelm BM, Splitthoff DN, Koethe U, Hamprecht FA. On oblique random forests. <em>Joint European Conference on Machine Learning and Knowledge Discovery in Databases</em> 2011 Sep 4; pp. 453-469. DOI: 10.1007/978-3-642-23783-6_29</p>
<p>Jaeger BC, Welden S, Lenoir K, Speiser JL, Segar MW, Pandey A, Pajewski NM. Accelerated and interpretable oblique random survival forests. <em>arXiv e-prints</em> 2022 Aug; arXiv-2208. URL: https://arxiv.org/abs/2208.01129</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># first example ----------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit an ORSF using default values, and get the default vi (anova)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="orsf.html">orsf</a></span><span class="op">(</span><span class="va">pbc_orsf</span>,</span></span>
<span class="r-in"><span>                    <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the printed output will indicate the type of vi used</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_default</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- Oblique random survival forest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Linear combinations: Accelerated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           N observations: 276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 N events: 111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  N trees: 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N predictors total: 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N predictors per node: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Average leaves per tree: 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min observations in leaf: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min events in leaf: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           OOB stat value: 0.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            OOB stat type: Harrell's C-statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Variable importance: anova</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the 'raw' vi values are stored in fit_default:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_default</span><span class="op">$</span><span class="va">importance</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     edema_1   ascites_1        bili      copper         age     albumin </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.39486139  0.36765722  0.28108673  0.19794953  0.18381026  0.16884475 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     protime       stage   edema_0.5        chol   spiders_1       sex_f </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.15291005  0.14971591  0.13615665  0.13108519  0.13073671  0.11851332 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ast        trig    hepato_1    alk.phos    platelet trt_placebo </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.11508351  0.10486599  0.10436668  0.09635753  0.07809278  0.06185286 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># these are 'raw' because the vi values for factors have not been</span></span></span>
<span class="r-in"><span><span class="co"># aggregated into a single vi value. Currently there is one vi value</span></span></span>
<span class="r-in"><span><span class="co"># for k-1 levels of a k level factor. For example, you can see edema_1</span></span></span>
<span class="r-in"><span><span class="co"># and edema_0.5 in the importance values above because edema is a factor</span></span></span>
<span class="r-in"><span><span class="co"># variable with levels of 0, 0.5, and 1. To get aggregated values of vi</span></span></span>
<span class="r-in"><span><span class="co"># across all levels of each factor, just call orsf_vi with group_factors</span></span></span>
<span class="r-in"><span><span class="co"># set to TRUE (the default)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">orsf_vi</span><span class="op">(</span><span class="va">fit_default</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ascites       bili      edema     copper        age    albumin    protime </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.36765722 0.28108673 0.24087047 0.19794953 0.18381026 0.16884475 0.15291005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      stage       chol    spiders        sex        ast       trig     hepato </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.14971591 0.13108519 0.13073671 0.11851332 0.11508351 0.10486599 0.10436668 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   alk.phos   platelet        trt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.09635753 0.07809278 0.06185286 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># orsf_vi knows that fit_default was fit using anova vi</span></span></span>
<span class="r-in"><span><span class="co"># to verify this, see that orsf_vi and orsf_vi_anova are the same</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">orsf_vi_anova</span><span class="op">(</span><span class="va">fit_default</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ascites       bili      edema     copper        age    albumin    protime </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.36765722 0.28108673 0.24087047 0.19794953 0.18381026 0.16884475 0.15291005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      stage       chol    spiders        sex        ast       trig     hepato </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.14971591 0.13108519 0.13073671 0.11851332 0.11508351 0.10486599 0.10436668 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   alk.phos   platelet        trt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.09635753 0.07809278 0.06185286 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># second example ---------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit an ORSF without vi, then add vi later</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_no_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="orsf.html">orsf</a></span><span class="op">(</span><span class="va">pbc_orsf</span>,</span></span>
<span class="r-in"><span>                  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span>,</span></span>
<span class="r-in"><span>                  importance <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: you can't call orsf_vi_anova() on fit_no_vi because anova</span></span></span>
<span class="r-in"><span><span class="co"># VI can only be computed while the forest is being grown.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">orsf_vi_negate</span><span class="op">(</span><span class="va">fit_no_vi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          bili           age       ascites        copper           sex </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0147426547  0.0094290477  0.0060429256  0.0059908314  0.0059387372 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         stage       protime         edema       spiders           ast </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0051573244  0.0038028756  0.0030946427  0.0028130861  0.0027609919 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          chol        hepato      platelet          trig           trt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0019274849  0.0012502605  0.0007814128  0.0001562826 -0.0015628256 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      alk.phos       albumin </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0018753907 -0.0019795791 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">orsf_vi_permute</span><span class="op">(</span><span class="va">fit_no_vi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          bili           age        copper       ascites         stage </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0149510315  0.0075536570  0.0053657012  0.0043759116  0.0037507814 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       protime       albumin           ast       spiders        hepato </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0032298395  0.0024484268  0.0021358616  0.0016149198  0.0012502605 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         edema      platelet      alk.phos          chol           sex </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0011522738  0.0007814128  0.0004167535 -0.0005730360 -0.0012502605 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          trig           trt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0013023547 -0.0014065430 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># third example ----------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit an ORSF and compute vi at the same time</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_permute_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="orsf.html">orsf</a></span><span class="op">(</span><span class="va">pbc_orsf</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span>,</span></span>
<span class="r-in"><span>                       importance <span class="op">=</span> <span class="st">'permute'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get the vi instantly (i.e., it doesn't need to be computed again)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">orsf_vi_permute</span><span class="op">(</span><span class="va">fit_permute_vi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          bili           age       albumin         stage       spiders </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0117732861  0.0109918733  0.0050010419  0.0032819337  0.0032298395 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       protime       ascites        copper      platelet         edema </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0027609919  0.0022921442  0.0015107314  0.0008335070  0.0007243573 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        hepato          chol      alk.phos           trt          trig </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0004688477  0.0003646593  0.0003125651 -0.0011460721 -0.0015107314 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           sex           ast </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0024484268 -0.0030735570 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can still get negation vi from this fit, but it needs to be computed</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">orsf_vi_negate</span><span class="op">(</span><span class="va">fit_permute_vi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          bili           age       protime       ascites        copper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0133882059  0.0122421338  0.0061992082  0.0058866431  0.0055219837 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       spiders         stage         edema           sex        hepato </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0040112523  0.0032819337  0.0030065788  0.0017712023  0.0013023547 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ast           trt      alk.phos      platelet       albumin </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0006251302 -0.0003125651 -0.0015107314 -0.0023963326 -0.0028130861 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          trig          chol </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0028651802 -0.0036986872 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Byron Jaeger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

