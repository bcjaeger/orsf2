<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to get started with the basics of aorsf.
">
<title>Introduction to aorsf • aorsf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to aorsf">
<meta property="og:description" content="Learn how to get started with the basics of aorsf.
">
<meta property="og:image" content="https://bcjaeger.github.io/aorsf/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aorsf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/aorsf.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pd.html">Compute partial dependence with ORSF</a>
    <a class="dropdown-item" href="../articles/oobag.html">Out-of-bag predictions and evaluation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcjaeger/aorsf/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="aorsf_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to aorsf</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bcjaeger/aorsf/blob/HEAD/vignettes/aorsf.Rmd" class="external-link"><code>vignettes/aorsf.Rmd</code></a></small>
      <div class="d-none name"><code>aorsf.Rmd</code></div>
    </div>

    
    
<p>This article covers core features of the <code>aorsf</code> package. Separate articles will cover these features in more detail.</p>
<div class="section level2">
<h2 id="background-orsf">Background: ORSF<a class="anchor" aria-label="anchor" href="#background-orsf"></a>
</h2>
<p>The oblique random survival forest (ORSF) is an extension of the axis-based RSF algorithm. Axis based RSFs can be fit with several R packages, including <code>RandomForestSRC</code>, <code>party</code>, and <code>ranger</code>. However, apart from <code>aorsf</code> and <code>obliqueRSF</code>, few R packages fit ORSFs.</p>
</div>
<div class="section level2">
<h2 id="what-is-an-oblique-decision-tree">What is an oblique decision tree?<a class="anchor" aria-label="anchor" href="#what-is-an-oblique-decision-tree"></a>
</h2>
<p>Decision trees are developed by splitting a set of training data into two new subsets, with the goal of having more similarity within the new subsets than between them. This splitting process is repeated on the resulting subsets of data until a stopping criterion is met. When the new subsets of data are formed based on a single predictor, the decision tree is said to be axis-based because the splits of the data appear perpendicular to the axis of the predictor. When linear combinations of variables are used instead of a single variable, the tree is oblique because the splits of the data are neither parallel nor at a right angle to the axis.</p>
<div class="figure">
<img src="tree_axis_v_oblique.png" alt="Decision trees for classification with axis-based splitting (left) and oblique splitting (right). Cases are orange squares; controls are purple circles. Both trees partition the predictor space defined by variables X1 and X2, but the oblique splits do a better job of separating the two classes." width="100%"><p class="caption">
Decision trees for classification with axis-based splitting (left) and oblique splitting (right). Cases are orange squares; controls are purple circles. Both trees partition the predictor space defined by variables X1 and X2, but the oblique splits do a better job of separating the two classes.
</p>
</div>
</div>
<div class="section level2">
<h2 id="accelerated-orsf">Accelerated ORSF<a class="anchor" aria-label="anchor" href="#accelerated-orsf"></a>
</h2>
<p>The purpose of <code>aorsf</code> (‘a’ is short for accelerated) is to provide routines to fit ORSFs that will scale adequately to large data sets. For example, <code><a href="../reference/orsf.html">aorsf::orsf()</a></code> runs hundreds of times faster than its predecessor, <code>obliqueRSF::ORSF()</code>.</p>
<p>To fit an accelerated ORSF model, use the <code>orsf</code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bcjaeger/aorsf" class="external-link">aorsf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">329</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orsf_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pbc_orsf</span>, </span>
<span>                 formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span>, </span>
<span>                 n_tree <span class="op">=</span> <span class="fl">2500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orsf_fit</span></span>
<span><span class="co">#&gt; ---------- Oblique random survival forest</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           N observations: 276</span></span>
<span><span class="co">#&gt;                 N events: 111</span></span>
<span><span class="co">#&gt;                  N trees: 2500</span></span>
<span><span class="co">#&gt;       N predictors total: 17</span></span>
<span><span class="co">#&gt;    N predictors per node: 5</span></span>
<span><span class="co">#&gt;  Average leaves per tree: 24</span></span>
<span><span class="co">#&gt; Min observations in leaf: 5</span></span>
<span><span class="co">#&gt;       Min events in leaf: 1</span></span>
<span><span class="co">#&gt;           OOB stat value: 0.84</span></span>
<span><span class="co">#&gt;            OOB stat type: Harrell's C-statistic</span></span>
<span><span class="co">#&gt;      Variable importance: anova</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>you may notice that the first input of <code>aorsf</code> is <code>data</code>. This is a design choice that makes it easier to use <code>orsf</code> with pipes (i.e., <code>%&gt;%</code> or <code>|&gt;</code>). For instance,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">orsf_fit</span> <span class="op">&lt;-</span> <span class="va">pbc_orsf</span> <span class="op">|&gt;</span> </span>
<span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h2>
<p><code>aorsf</code> includes several functions dedicated to interpretation of ORSFs, both through estimation of partial dependence and variable importance.</p>
<div class="section level3">
<h3 id="variable-importance">Variable importance<a class="anchor" aria-label="anchor" href="#variable-importance"></a>
</h3>
<p><code>aorsf</code> provides multiple ways to compute variable importance.</p>
<ul>
<li>
<p>To compute negation importance, ORSF multiplies each coefficient of that variable by -1 and then re-computes the out-of-sample (sometimes referred to as out-of-bag) accuracy of the ORSF model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/orsf_vi.html">orsf_vi_negate</a></span><span class="op">(</span><span class="va">orsf_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;          bili           age           sex        copper       ascites </span></span>
<span><span class="co">#&gt;  0.0131798291  0.0099499896  0.0070848093  0.0058866431  0.0043759116 </span></span>
<span><span class="co">#&gt;       spiders       protime         edema           ast       albumin </span></span>
<span><span class="co">#&gt;  0.0030214628  0.0025526151  0.0017811250  0.0010939779 -0.0004688477 </span></span>
<span><span class="co">#&gt;        hepato          chol      alk.phos          trig      platelet </span></span>
<span><span class="co">#&gt; -0.0011460721 -0.0015628256 -0.0019795791 -0.0028130861 -0.0041154407 </span></span>
<span><span class="co">#&gt;           trt </span></span>
<span><span class="co">#&gt; -0.0041675349</span></span></code></pre></div>
</li>
<li>
<p>You can also compute variable importance using permutation, a more classical approach.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/orsf_vi.html">orsf_vi_permute</a></span><span class="op">(</span><span class="va">orsf_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;          bili           age        copper       ascites         stage </span></span>
<span><span class="co">#&gt;  0.0090122942  0.0079704105  0.0058866431  0.0027609919  0.0025526151 </span></span>
<span><span class="co">#&gt;          chol       albumin       protime           sex       spiders </span></span>
<span><span class="co">#&gt;  0.0025005209  0.0018232965  0.0011981663  0.0007814128  0.0007293186 </span></span>
<span><span class="co">#&gt;           ast      platelet         edema        hepato      alk.phos </span></span>
<span><span class="co">#&gt;  0.0006251302 -0.0003646593 -0.0004291569 -0.0007293186 -0.0011981663 </span></span>
<span><span class="co">#&gt;          trig           trt </span></span>
<span><span class="co">#&gt; -0.0015107314 -0.0029172744</span></span></code></pre></div>
</li>
<li>
<p>A faster alternative to permutation and negation importance is ANOVA importance, which computes the proportion of times each variable obtains a low p-value (p &lt; 0.01) while the forest is grown.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/orsf_vi.html">orsf_vi_anova</a></span><span class="op">(</span><span class="va">orsf_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ascites       bili      edema     copper    albumin        age      stage </span></span>
<span><span class="co">#&gt; 0.30967826 0.24619998 0.21284981 0.17863634 0.15186989 0.14669863 0.14480409 </span></span>
<span><span class="co">#&gt;    protime    spiders     hepato       chol        sex        ast       trig </span></span>
<span><span class="co">#&gt; 0.12863221 0.12539359 0.12171568 0.11761006 0.11391341 0.11385624 0.07588287 </span></span>
<span><span class="co">#&gt;   alk.phos        trt   platelet </span></span>
<span><span class="co">#&gt; 0.06324233 0.06046357 0.05202554</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="partial-dependence">Partial dependence<a class="anchor" aria-label="anchor" href="#partial-dependence"></a>
</h3>
<p>Partial dependence shows the expected prediction from an ORSF model for a given set of predictor values.</p>
<ul>
<li>
<p><code><a href="../reference/orsf_pd_summary.html">orsf_pd_summary()</a></code> shows summary values of predictions for the given set of predictor values</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># make a list containing the variable values you</span></span>
<span><span class="co"># want to compute partial dependence for</span></span>
<span><span class="va">pd_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>edema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"0.5"</span>, <span class="st">"1"</span><span class="op">)</span>,</span>
<span>                bili <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">7.1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># orsf_pd_summary automatically computes pd for all combinations</span></span>
<span><span class="co"># in the list (this can be turned off with expand_grid = FALSE)</span></span>
<span><span class="va">pd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf_pd_summary.html">orsf_pd_summary</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">orsf_fit</span>, </span>
<span>                           pd_spec <span class="op">=</span> <span class="va">pd_spec</span>,</span>
<span>                           expand_grid <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                           pred_horizon <span class="op">=</span> <span class="fl">365.25</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pd_data</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bili</span>, y <span class="op">=</span> <span class="va">mean</span>, col <span class="op">=</span> <span class="va">edema</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">'Predicted risk'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'Bilirubin'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Partial dependence of bilirubin and edema'</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="aorsf_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</li>
<li>
<p><code><a href="../reference/orsf_pd_summary.html">orsf_pd_ice()</a></code> shows predictions for each observation if the specified predictors are fixed at the specified predictor values.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># make a list containing the variable values you</span></span>
<span><span class="co"># want to compute partial dependence for</span></span>
<span><span class="va">pd_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>edema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"0.5"</span>, <span class="st">"1"</span><span class="op">)</span>,</span>
<span>                bili <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">7.1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># orsf_pd_summary automatically computes pd for all combinations</span></span>
<span><span class="co"># in the list (this can be turned off with expand_grid = FALSE)</span></span>
<span><span class="va">pd_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf_pd_summary.html">orsf_pd_ice</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">orsf_fit</span>, </span>
<span>                       pd_spec <span class="op">=</span> <span class="va">pd_spec</span>,</span>
<span>                       expand_grid <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                       pred_horizon <span class="op">=</span> <span class="fl">365.25</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pd_data</span><span class="op">$</span><span class="va">edema</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Edema ="</span>, <span class="va">pd_data</span><span class="op">$</span><span class="va">edema</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pd_data</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bili</span>, y <span class="op">=</span> <span class="va">pred</span>, group <span class="op">=</span> <span class="va">id_row</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'grey'</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">'Predicted risk'</span>,</span>
<span>      x <span class="op">=</span> <span class="st">'Bilirubin'</span>,</span>
<span>      title <span class="op">=</span> <span class="st">'Partial dependence of bilirubin and edema'</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">edema</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="aorsf_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="summarize-orsf-models">Summarize ORSF models<a class="anchor" aria-label="anchor" href="#summarize-orsf-models"></a>
</h3>
<p>Getting straight to variable importance and partial dependence in a direct way can often be helpful in exploratory analyses. When you want a lot of information for just a little code, <code><a href="../reference/orsf_summarize_uni.html">orsf_summarize_uni()</a></code> is the tool for you:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/orsf_summarize_uni.html">orsf_summarize_uni</a></span><span class="op">(</span><span class="va">orsf_fit</span>, </span>
<span>                   n_variables <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                   pred_horizon <span class="op">=</span> <span class="fl">365.25</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- bili (VI Rank: 1) ---------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        |---------------- risk ----------------|</span></span>
<span><span class="co">#&gt;  Value      Mean    Median     25th %    75th %</span></span>
<span><span class="co">#&gt;   0.80 0.2429583 0.1284750 0.04840256 0.3928055</span></span>
<span><span class="co">#&gt;    1.4 0.2596384 0.1457900 0.05914073 0.4120615</span></span>
<span><span class="co">#&gt;    3.5 0.3458558 0.2498307 0.13723033 0.5227983</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- age (VI Rank: 2) ----------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        |---------------- risk ----------------|</span></span>
<span><span class="co">#&gt;  Value      Mean    Median     25th %    75th %</span></span>
<span><span class="co">#&gt;     42 0.2674831 0.1409063 0.04296130 0.4512338</span></span>
<span><span class="co">#&gt;     50 0.2945834 0.1737065 0.05097475 0.5017808</span></span>
<span><span class="co">#&gt;     57 0.3276076 0.2193830 0.07385959 0.5367037</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- sex (VI Rank: 3) ----------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        |---------------- risk ----------------|</span></span>
<span><span class="co">#&gt;  Value      Mean    Median     25th %    75th %</span></span>
<span><span class="co">#&gt;      m 0.3560382 0.2469748 0.12206421 0.5731464</span></span>
<span><span class="co">#&gt;      f 0.2912662 0.1552082 0.05092011 0.5253999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- copper (VI Rank: 4) -------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        |---------------- risk ----------------|</span></span>
<span><span class="co">#&gt;  Value      Mean    Median     25th %    75th %</span></span>
<span><span class="co">#&gt;     43 0.2626844 0.1415148 0.04755781 0.4371901</span></span>
<span><span class="co">#&gt;     74 0.2792341 0.1554124 0.05827489 0.4609205</span></span>
<span><span class="co">#&gt;    129 0.3265006 0.2159967 0.10072831 0.5345941</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -- ascites (VI Rank: 5) ------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        |---------------- risk ----------------|</span></span>
<span><span class="co">#&gt;  Value      Mean    Median     25th %    75th %</span></span>
<span><span class="co">#&gt;      0 0.2931932 0.1576125 0.05434581 0.5253999</span></span>
<span><span class="co">#&gt;      1 0.4279745 0.3372134 0.21379450 0.6286554</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Predicted risk at time t = 1826.25 for top 5 predictors</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="what-about-the-original-orsf">What about the original ORSF?<a class="anchor" aria-label="anchor" href="#what-about-the-original-orsf"></a>
</h2>
<p>The original ORSF (i.e., <code>obliqueRSF</code>) used <code>glmnet</code> to find linear combinations of inputs. <code>aorsf</code> allows users to implement this approach using the <code><a href="../reference/orsf_control_net.html">orsf_control_net()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">orsf_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pbc_orsf</span>, </span>
<span>                 formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span>, </span>
<span>                 control <span class="op">=</span> <span class="fu"><a href="../reference/orsf_control_net.html">orsf_control_net</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 n_tree <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><code>net</code> forests fit a lot faster than the original ORSF function in <code>obliqueRSF</code>. However, <code>net</code> forests are still much slower than <code>cph</code> ones:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># tracking how long it takes to fit 50 glmnet trees</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span> <span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pbc_orsf</span>, </span>
<span>       formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span>, </span>
<span>       control <span class="op">=</span> <span class="fu"><a href="../reference/orsf_control_net.html">orsf_control_net</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       n_tree <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span> <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   2.905   0.000   2.905</span></span>
<span></span>
<span><span class="co"># and how long it takes to fit 50 cph trees</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span> <span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/orsf.html">orsf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pbc_orsf</span>, </span>
<span>       formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span>, </span>
<span>       control <span class="op">=</span> <span class="fu"><a href="../reference/orsf_control_cph.html">orsf_control_cph</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       n_tree <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span> <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.051   0.000   0.051</span></span>
<span></span>
<span><span class="va">t1</span><span class="op">[</span><span class="st">'elapsed'</span><span class="op">]</span> <span class="op">/</span> <span class="va">t2</span><span class="op">[</span><span class="st">'elapsed'</span><span class="op">]</span></span>
<span><span class="co">#&gt;  elapsed </span></span>
<span><span class="co">#&gt; 56.96078</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="aorsf-and-other-machine-learning-software">aorsf and other machine learning software<a class="anchor" aria-label="anchor" href="#aorsf-and-other-machine-learning-software"></a>
</h2>
<p>Generally, <code>aorsf</code> follows conventions set by the R packages <code>randomForest</code> and <code>randomForestSRC</code>. For example, the <code>print</code> method for <code>aorsf</code> models is very similar to <code>randomForestSRC</code> models, as is the specification of computing variable importance and the objects returned by variable importance functions. Similar to <code>randomForestSRC</code>, <code>aorsf</code> allows and recommends partial dependence to be estimated using out-of-bag data.</p>
<p>The unique feature of <code>aorsf</code> is fitting oblique random survival forests fast while maintaining strong prediction accuracy. <code>RLT</code> and <code>obliqueRSF</code> both fit oblique random survival forests, but <code>aorsf</code> does so faster. <code>ranger</code> and <code>randomForestSRC</code> fit survival forests, but neither package supports oblique splitting. <code>obliqueRF</code> fits oblique random forests for classification and regression, but not survival. <code>PPforest</code> fits oblique random forests for classification but not survival. The default prediction behavior for <code>aorsf</code> models is to produce predicted risk at a specific prediction horizon, which is not the default for <code>ranger</code> or <code>randomForestSRC</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Byron Jaeger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
